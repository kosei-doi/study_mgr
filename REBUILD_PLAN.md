# 学習進捗管理アプリ（リビルド版）企画書（使いやすさ最優先）

## 1. 目的（何を実現するか）
- とにかく「使いやすい」ことを最優先。
- 時間割をクリック → その場で進捗/時間を更新 → すぐ反映。
- 余計な設定や画面遷移は極力なくす（1画面完結）。

## 2. スコープ（入れるもの / 省くもの）
- 入れる
  - 全画面の時間割。セルクリックでモーダル（進捗+1、数値入力、時間加算）。
  - 分母モードトグル（画面右上）
    - 既定: 現在週数（＝今日までに実施済みの回数／最低1を保証）
    - 切替: 総授業回数（曜日ごとの総回数）
  - 授業日は固定配列（classDays）で管理（休講などは配列に直接反映）。
  - 進捗色（0%/低/中/高/完了）とライト/ダークのテーマ保持。
  - データはすべて `localStorage` のみ。
- 省く（使い勝手を下げるもの・初期は不要なもの）
  - 休講・補講のUI入力（配列直編集のみ）。
  - タイマーの高度機能（再開/アイドル検知等）。まずは「手動加算ボタン＋簡易タイマー」程度。
  - ストレージのバージョニング、過度な統計、複数タブ同期。

## 3. コアUX（使い方の核）
- 時間割セルをクリック → モーダルが開く →
  - 「+1」ボタンで理解回数を素早く加算
  - 数値で直接入力も可能
  - 学習時間は分単位で加算（簡易）
- 保存した瞬間にセル内のバーと数値が更新（ラグなし）。

## 4. 成果物と構成
- 単一ページ（HTML/CSS/JS）。
- 構成
  - `index.html`（UI）
  - `styles.css`（配色とレイアウト）
  - `app.js`（最小ロジック）
  - `data/classDays.js`（授業日の固定配列のみ）
  - `README.md`（簡潔な使い方）

## 5. 必須仕様
### 5.1 時間割
- 固定グリッド（例: 月〜金 × 1〜5限）。
- セル表示
  - 科目名（複数コマは先頭セルに「2-5限」など範囲表記、後続セルは空だがクリック可）
  - 進捗バーと数値（`X/Y`）

### 5.2 分母モード（右上トグル）
- 既定: 現在週数（今日までの実施回数）。分母は最低1。
- 切替: 総授業回数（曜日の総回数）。
- トグル横に「i」アイコンの簡易ツールチップ（何を基準にしているかを短文で説明）。

### 5.3 授業日（classDays）
- 提供済み期間で作成した固定配列のみを使用（UIでの編集はしない）。
- 構造: `{ date: 'YYYY-MM-DD', dayOfWeek: '月曜日'|'火曜日'|... }`。
- 例外日は配列から直接除外済み（例: 2026-01-12）。

### 5.4 現在週数の定義
- `week = その曜日のclassDaysで、date <= 今日 の件数`。
- UI表示は `displayWeek = max(week, 1)` を使用。

### 5.5 進捗色（ライト/ダーク対応）
- 0%: グレー / 1〜24%: 赤 / 25〜49%: オレンジ / 50〜74%: 緑 / 75〜100%: 青

### 5.6 複数コマの扱い
- 先頭セルに「科目名＋範囲（例: 2-5限）」とバー/数値。
- 後続セルは空表示だがクリックで同じモーダルを開く（情報は1か所に集約）。

### 5.7 学習時間
- 1分単位の手動加算（必要最小限）。
- 簡易タイマーは後回し（まずは手動で使いやすく）。

## 6. データモデル（localStorage）
- `subject-progress`: `[{ id, name, progress, totalTime, lastUpdated }]`
- `theme`: `'light'|'dark'`
- `classDays`: 初回ロード時に固定配列を保存（存在すれば再利用）

## 7. 画面・UI/UX（最小で快適）
- 1画面完結。上部に簡易統計（総時間、全体達成率、完了科目数）。
- 右上に分母トグル＋「i」説明。
- 今日の曜日列/日付を軽くハイライト（迷わない）。
- ダークモード切替は保存。

## 8. 技術スタック
- HTML/CSS（CSS変数） + バニラJS（ES Modules）
- ビルド不要。静的配信でOK。

## 9. モジュール
- `app.js`: 起動/状態/描画/イベント最小実装
- `data/classDays.js`: 固定配列をexport（JSのみ）
- 主要関数（必要最小限）
  - `loadSubjects()` / `saveSubjects()`
  - `getDayForSubject(name)` / `getClassDaysByWeekday(weekday)`
  - `getCurrentWeekForSubject(name, today)` / `getTotalClassesForSubject(name)`
  - `updateTimetableProgressBars()`
  - `showSubjectModal(name, slot)` / `applyProgressUpdate()`

## 10. 受け入れ基準（簡潔）
- 2025-10-10（金）時点
  - 月/火/水: 分母1、木/金: 分母2（現在週数モード）
  - 金曜の科目が `0/2` と表示
  - UI崩れなし、テーマ保持
- 学期最終日までに分母が最終週に到達（曜日総数に一致）

## 11. テスト（必要最小限）
- 代表日で `getCurrentWeekForSubject` を手動検証（5日付）。
- UI: 進捗+1、時間加算、テーマ切替、再読み込み保持。

## 12. アクセシビリティ（基本）
- 十分なコントラストとフォーカスリング。
- セルに `aria-label`（科目名/進捗）。
- Escでモーダル閉じ、Enterで保存。

## 13. パフォーマンス
- 依存ライブラリなし、初期ロード軽量（<100KB目標）。

## 14. リスクと対策
- 仕様ぶれ: 分母トグルとclassDaysをソース先頭に明記（コメント）。
- 日付不整合: classDaysは配列一本化・事前検算、編集時は再検算スクリプトでチェック。

## 15. スケジュール（短期）
- Day 1: 企画書確定・雛形・classDays導入
- Day 2: 時間割/モーダル/保存
- Day 3: 進捗バー/色/週数/統計・仕上げ

## 16. 将来拡張（後で検討）
- 縦バー連結などの視覚強化をトグルでON/OFF。
- CSV/JSONエクスポート、AI支援、同期機能。

---
この企画書に沿って最小構成（index.html / styles.css / app.js / data/classDays.js）から実装を開始します。


